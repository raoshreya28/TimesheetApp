<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">

    <title>Login - Timesheet App</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="style.css">

</head>

<body>

    <div class="card p-4">

        <h3 class="text-center mb-3">Login</h3>

        <form id="loginForm">

            <div class="mb-3">

                <label>Email</label>

                <input type="email" class="form-control" id="email" required>

            </div>

            <div class="mb-3">

                <label>Password</label>

                <input type="password" class="form-control" id="password" required>

            </div>

            <button class="btn btn-success w-100">Login</button>

        </form>

        <p class="mt-3 text-center">New user? <a href="register.html">Register</a></p>

    </div>



    <script>

        // Get the form element

        const loginForm = document.getElementById("loginForm");



        // Add an event listener 

        loginForm.addEventListener("submit", async (e) => {

            e.preventDefault(); 



           

            const payload = {

                Email: document.getElementById("email").value,

                Password: document.getElementById("password").value

            };



            // Try to log in

            try {

                const res = await fetch("https://localhost:7093/api/employee/login", {

                    method: "POST",

                    headers: { "Content-Type": "application/json" },

                    body: JSON.stringify(payload)

                });



                // If the response is successful

                if (res.ok) {

                    const data = await res.json();

                    // Store employee info and redirect

                    localStorage.setItem("employeeId", data.employeeId);

                    localStorage.setItem("employeeName", data.name);

                    window.location.href = "timesheet.html";

                } else {

                    // If not, show the error message from the server

                    const err = await res.text();

                    alert("Login failed: " + err);

                }

            } catch (err) {

               

                alert("Error: Could not connect to the server.");

            }

        });

    </script>

</body>

</html>